let c="ko",u={};function f(){try{const a=localStorage.getItem("language");if(a)return a}catch(a){console.warn("localStorage unavailable:",a)}return(navigator.language||navigator.userLanguage).startsWith("en")?"en":"ko"}async function l(t){try{const n=[`/lux-vera/i18n/${t}.json`,`./i18n/${t}.json`,`../i18n/${t}.json`];let e,o;for(const r of n)try{if(e=await fetch(r),e.ok)break}catch(g){o=g}if(!e||!e.ok)throw o||new Error("Failed to load translations");u=await e.json(),c=t;try{localStorage.setItem("language",t)}catch(r){console.warn("localStorage unavailable:",r)}return!0}catch{return!1}}function s(t){const a=t.split(".");let n=u;for(const e of a)if(n&&typeof n=="object"&&e in n)n=n[e];else return t;return n}function d(){const t=document.querySelector(".language-toggle");t&&(t.textContent=c==="ko"?"ðŸ‡ºðŸ‡¸ EN":"ðŸ‡°ðŸ‡· KO")}function i(){document.querySelectorAll("[data-i18n]").forEach(a=>{const n=a.getAttribute("data-i18n"),e=s(n),o=a.getAttribute("data-i18n-attr");o?o.split(",").forEach(r=>{a.setAttribute(r.trim(),e)}):a.tagName==="INPUT"||a.tagName==="TEXTAREA"?a.placeholder=e:a.innerHTML=e});const t=document.querySelector("title[data-i18n]");t&&(document.title=s(t.getAttribute("data-i18n"))),document.documentElement.lang=c,d()}async function h(t){const a=await l(t);return a&&(i(),window.dispatchEvent(new CustomEvent("languageChanged",{detail:{lang:t}}))),a}async function w(){const t=f();await l(t),i()}function b(){return c}const y={init:w,t:s,changeLanguage:h,getCurrentLanguage:b,updatePageContent:i};export{y as I};
